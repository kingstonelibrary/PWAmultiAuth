<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Firebase Auth for Twitter</title>
</head>
<body>
  <h1>...Please wait</h1>
  <div id="info"></div>

  <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-auth.js"></script>
  <script src="mainTWT.js"></script>
  <script>
    firebase.auth().onAuthStateChanged( (user) => {
      let h1   = document.querySelector('h1');
      let info = document.querySelector('#info');

      if(user) {
        /*  
            本当はここで、認証をメールで行っていた場合は、そのメール確認ができているかどうかの確認をしたい
            （要件１）この”user”はメールでの認証をしたユーザー華道家の判定
            （要件２）メール認証の場合、下記コードでメール確認済みかどうか分岐する
              // if( user.emailVerified ) {
              //   showMessage('Login Complete!', `${user.displayName}さんがログインしました`);
              //   return;
              // }
              // else {
              //   user.sendEmailVerification()
              //     .then(()=>{
              //       showMessage('Send confirm mail', `${user.email}宛に確認メールを送信しました`);
              //     })
              //     .catch((error)=>{
              //       showMessage('[Error] Can not send mail', `${user.email}宛に確認メールを送信できませんでした: ${error}`);
              //     });
              // }
        */
        h1.innerText   = 'Login Complete!';
        info.innerHTML = `${user.displayName}さんがログインしました<br>` +
                         `(${user.uid})+(${user.auth})`;
        console.log(user);
      }
      else {
        h1.innerText = 'Not Login';
      }
    });
  </script>
</body>
</html>
